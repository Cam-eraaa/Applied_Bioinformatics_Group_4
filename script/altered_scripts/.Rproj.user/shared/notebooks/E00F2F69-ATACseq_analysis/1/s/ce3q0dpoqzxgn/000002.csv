"0","# Load the sample data"
"0","sampleInfoFile = paste(params$workingDir, params$sampleInfo, sep = ""/"")"
"0","sampleInfo = read.table("
"0","  file = sampleInfoFile,"
"0","  header = TRUE,"
"0","  sep = ""\t"","
"0","  quote = """","
"0","  stringsAsFactors = FALSE"
"0",")"
"0",""
"0","#Change the names of bamFiles2 so that they make more sense"
"0","sampleInfo$bamFiles2  =  gsub(pattern = ""/"","
"0","                              replacement = ""."","
"0","                              x = sampleInfo$bamFiles)"
"0","sampleInfo$bamFiles2  =  gsub(pattern = ""-"","
"0","                              replacement = ""."","
"0","                              x = sampleInfo$bamFiles2)"
"0",""
"0","# Rename the mutants in sampledata so that the names are universal for the data"
"0","sampleInfo$Genotype = recode(sampleInfo$Genotype, Toll910 = ""Toll9"")"
"0","sampleInfo$Genotype = recode(sampleInfo$Genotype, `Toll9/10` = ""Toll9"")"
"0","sampleInfo$Genotype = recode(sampleInfo$Genotype, gd7 = ""Gd7"")"
"0",""
"0","# Filter out the sampleInfo that is not ATACseq"
"0","sampleInfo = sampleInfo %>% filter(Assaytype == params$Method)"
"0","#sampleInfoCountTable = data.frame(bamFiles2 = colnames(countData))"
"0",""
"0",""
"0","#sampleInfo = inner_join(sampleInfo, sampleInfoCountTable)"
"0",""
"0","#Make sure that the columns in countData is the same as the name of the bamfiles2 in sampleInfo"
"0","countData = countData[, sampleInfo$bamFiles2]"
"0",""
"0","#Change NA in sampleinfo$uclearsample to Mutant"
"0","sampleInfo$Nuclearcycle[is.na(sampleInfo$Nuclearcycle)] = ""Mutant"""
"0",""
"0",""
"0","#Rename the columns in countData"
"0","colnames(countData) = sampleInfo$SampleInfo"
"0",""
"0","#Divide sampleInfo into fixed and spiked samples. "
"0","fixedSamples = sampleInfo$SampleInfo[grep(pattern = ""Fixed"", x = sampleInfo$SampleInfo)]"
"0","spikedSamples = sampleInfo$SampleInfo[grep(pattern = ""spiked"", x = sampleInfo$SampleInfo)]"
"0",""
"0","#Create sampleInfo_Mutants with only mutants and that are not in either fixed or spiked"
"0","sampleInfo_Mutants = sampleInfo %>% filter(Nuclearcycle == ""Mutant"") %>%"
"0","  filter(!SampleInfo %in% fixedSamples) %>%"
"0","  filter(!SampleInfo %in% spikedSamples)"
"0",""
"0","#Create a count data table from these"
"0","countData_mutants = countData[, sampleInfo_Mutants$SampleInfo]"
"0",""
"0",""
