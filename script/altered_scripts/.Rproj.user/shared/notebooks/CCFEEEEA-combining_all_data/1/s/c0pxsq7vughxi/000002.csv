"0","# Loading the gtf file to extract annotation."
"0","gtfFile = paste(params$workingDir,"
"0","                ""Drosophila_melanogaster.BDGP6.28.101.gtf"","
"0","                sep = ""/"")"
"0","gtfInfo = read.table("
"0","  file = gtfFile,"
"0","  header = F,"
"0","  sep = ""\t"","
"0","  quote = """","
"0","  stringsAsFactors = F"
"0",")"
"0","# Chosing only the annotation for genes"
"0","gtfInfoGene = gtfInfo %>% dplyr::filter(V3 == ""gene"")"
"0","# Extract only gene name and geneID"
"0","gtfInfoGene = gtfInfoGene[grep(pattern = ""gene_biotype \""protein_coding\"""", x = gtfInfoGene$V9),]"
"0","gtfInfoGene = gtfInfoGene %>% separate("
"0","  col = V9,"
"0","  sep = "";"","
"0","  into =  c(""geneID1"", ""geneName1"", ""gene_source"", ""gene_biotype"", ""empty"")"
"0",")"
"0","gtfInfoGene = gtfInfoGene %>% separate("
"0","  col = geneID1,"
"0","  sep = ""\"""","
"0","  into =  c(""irrelevant"", ""geneID"", ""empty"")"
"0",")"
"0","gtfInfoGene = gtfInfoGene %>% separate("
"0","  col = geneName1,"
"0","  sep = ""\"""","
"0","  into =  c(""irrelevant1"", ""geneName"", ""empty"")"
"0",")"
"0","#gtfInfoGene = gtfInfoGene$geneID"
"0",""
"0","###### Contiune to fix the data frame gtfInfoGene"
"0","gtfInfoAnnotation = gtfInfoGene  %>% select(V1, V4, V5, V7, geneID, geneName)"
"0",""
"0","# Summerize the information in a table with Chr, start, stop, direction,"
"0","PROseqGenes = gtfInfoAnnotation %>% dplyr::rename("
"0","  ""Chr"" = V1,"
"0","  ""GeneStart"" = V4,"
"0","  ""GeneStop"" = V5,"
"0","  ""geneDir"" = V7"
"0",")"
"0","PROseqGenes$Chr = paste (""chr"", PROseqGenes$Chr, sep = """")"
"0",""
"0","#Extract RNA information"
"0","gtfInfomRNA = gtfInfo %>% dplyr::filter(V3 == ""transcript"")"
"0","#Extract geneID and transcriptID"
"0","gtfInfomRNA = gtfInfomRNA[grep(pattern = ""gene_biotype \""protein_coding\"""", x = gtfInfomRNA$V9),]"
"0","gtfInfomRNA_DF = gtfInfomRNA %>% separate("
"0","  col = V9,"
"0","  sep = "";"","
"0","  into =  c(""geneID1"", ""transcriptID1"")"
"0",")"
"2","Expected 2 pieces. Additional pieces discarded in 30588 rows [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, ...]."
"0","gtfInfomRNA_DF = gtfInfomRNA_DF %>% separate(col = geneID1,"
"0","                                             sep = ""\"""","
"0","                                             into =  c(""irrelevant"", ""geneID""))"
"2","Expected 2 pieces. Additional pieces discarded in 30588 rows [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, ...]."
"0","gtfInfomRNA_DF = gtfInfomRNA_DF %>% separate("
"0","  col = transcriptID1,"
"0","  sep = ""\"""","
"0","  into =  c(""irrelevant1"", ""transcriptID"")"
"0",")"
"2","Expected 2 pieces. Additional pieces discarded in 30588 rows [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, ...]."
"0","gene2transcriptInfo  = gtfInfomRNA_DF %>% dplyr::select(geneID, transcriptID)"
