"0",""
"0","# Loading the gtf file to extract annotation. "
"0","gtfFile = paste(params$workingDir, ""Drosophila_melanogaster.BDGP6.28.101.gtf"", sep = ""/"")"
"0","gtfInfo = read.table(file = gtfFile, header = F, sep = ""\t"", quote = """", stringsAsFactors = F)"
"0","# Chosing only the annotation for genes"
"0","gtfInfoGene = gtfInfo %>% dplyr::filter(V3 == ""gene"")"
"0","# Extract only gene name and geneID"
"0","gtfInfoGene = gtfInfoGene[grep(pattern = ""gene_biotype \""protein_coding\"""",x = gtfInfoGene$V9 ),  ] "
"0","gtfInfoGene= gtfInfoGene %>% separate(col = V9,sep = "";"",into =  c(""geneID1"", ""geneName1"", ""gene_source"", ""gene_biotype"", ""empty""))"
"0","gtfInfoGene= gtfInfoGene %>% separate(col = geneID1,sep = ""\"""",into =  c(""irrelevant"", ""geneID"", ""empty""))"
"0","gtfInfoGene= gtfInfoGene %>% separate(col = geneName1,sep = ""\"""",into =  c(""irrelevant1"", ""geneName"", ""empty""))"
"0","#gtfInfoGene = gtfInfoGene$geneID"
"0",""
"0","###### Contiune to fix the data frame gtfInfoGene"
"0","gtfInfoAnnotation = gtfInfoGene  %>% select(V1,V4,V5,V7,geneID,geneName)"
"0",""
"0","# Summerize the information in a table with Chr, start, stop, direction, "
"0","PROseqGenes = gtfInfoAnnotation %>% dplyr::rename(""Chr""= V1, ""GeneStart"" = V4,""GeneStop"" = V5,""geneDir"" = V7)"
"0","PROseqGenes$Chr = paste (""chr"",PROseqGenes$Chr, sep ="""")"
"0",""
"0","#Extract RNA information"
"0","gtfInfomRNA = gtfInfo %>% dplyr::filter(V3 == ""transcript"")"
"0","#Extract geneID and transcriptID"
"0","gtfInfomRNA = gtfInfomRNA[grep(pattern = ""gene_biotype \""protein_coding\"""",x = gtfInfomRNA$V9 ),  ] "
"0","gtfInfomRNA_DF= gtfInfomRNA %>% separate(col = V9,sep = "";"",into =  c(""geneID1"", ""transcriptID1""))"
"2","Expected 2 pieces. Additional pieces discarded in 30588 rows [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, ...]."
"0","gtfInfomRNA_DF= gtfInfomRNA_DF %>% separate(col = geneID1,sep = ""\"""",into =  c(""irrelevant"", ""geneID""))"
"2","Expected 2 pieces. Additional pieces discarded in 30588 rows [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, ...]."
"0","gtfInfomRNA_DF= gtfInfomRNA_DF %>% separate(col = transcriptID1,sep = ""\"""",into =  c(""irrelevant1"", ""transcriptID""))"
"2","Expected 2 pieces. Additional pieces discarded in 30588 rows [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, ...]."
"0","gene2transcriptInfo  = gtfInfomRNA_DF %>% dplyr::select(geneID,transcriptID)"
"0",""
